reset()

var('Z')

mu = 1.0 / 20.0
c_n, c_T = -1.1, -0.9
a, b, c = 3.0/2.0, 2.0, -1.0
Z_S = -3.0/2.0

# At t = 0
#0.49	0.683706980466396	1.32496145938483	-0.0206250867984561	5
#0.51	0.691213814264995	1.33027412776876	-0.0191672209048899	5
#0.53	0.698719562491543	1.33554223315998	-0.0177733476721204	5

# At t = 135
#0.49	0.610660563155032	1.30411254952973	-3.06036908428267	2.66118461102601
#0.51	0.618549890710752	1.31299641246706	-3.05151915868033	2.66386371895
#0.53	0.626467999984115	1.32173998954979	-3.0425333319374	2.66544015688424
# .........
#0.99	0.981110868143376	1.63421628926577	-1.48108678379191	0.491444796219089
#1.01	0.999673727872353	1.64981311266731	-1.28285663026662	0.499537912103461
#1.03	1.01660486587383	1.66401200235489	-1.09300528560897	0.513478891305364
# .........
#1.99	1.2435198107485	1.79762273772508	0.141694442025275	4.9908892834125
#2.01	1.24801940647034	1.79934360213636	0.141647858350999	4.99089991282975
#2.03	1.2525541146463	1.80107077486164	0.141626086988019	4.99090015667972

t = (0, 135, 135, 135)
x = (0.51, 0.51, 1.01, 2.01)
density = (0.691213814264995, 0.618549890710752, 0.999673727872353, 1.24801940647034)
density_grad = ((0.698719562491543 - 0.683706980466396) / 0.04,\
		(0.610660563155032 - 0.626467999984115) / 0.04,\
		(1.01660486587383 - 0.981110868143376) / 0.04,\
		(1.2525541146463 - 1.2435198107485) / 0.04)
temperature = (1.33027412776876, 1.31299641246706, 1.64981311266731, 1.79934360213636)
temperature_grad = ((1.33554223315998 - 1.32496145938483) / 0.04,\
		(1.32173998954979 - 1.30411254952973) / 0.04,\
		(1.66401200235489 - 1.63421628926577) / 0.04,\
		(1.80107077486164 - 1.79762273772508) / 0.04)
Z_grad_grad = (((-0.0191672209048899 + 0.0206250867984561) / 0.02) - ((-0.0177733476721204 + 0.0191672209048899) / 0.02)) / 0.03 

colors = rainbow(len(x) + 1)

G(Z) = a + b*(Z - Z_S) + c*(Z - Z_S)^3

steady_state_plots = []

for j in range(len(x)):
	f(Z) = (c_n * temperature[j] / density[j]^2) * density_grad[j] + (c_T / density[j]) * temperature_grad[j] + G(Z)
	steady_state_plots.append(plot(f, (Z,-3.5,1.5), ymin=-3, ymax=4,\
			gridlines=True, color=colors[j], axes_labels=["$Z$",""],\
			thickness=2.0, legend_label="$x = " +str(x[j].n(digits=3))\
			+"$, $t = " +str(t[j].n(digits=3))+ "$"))

steady_state_plots.append(plot(G, (Z,-3.5,1.5), gridlines=True,\
		color=colors[-1], thickness=2.0, legend_label="$G(Z)$"))

equation_label = text(r"$f(Z) = \frac{c_n \, T}{n^2} \, \frac{\partial n}{\partial x} \,+\, \frac{c_T}{n} \, \frac{\partial T}{\partial x} \,+\, G(Z)$",\
		(-2,-2.5), bounding_box={'boxstyle': 'round', 'fc': 'w'},\
		fontsize=18, color='black')

combined_plots = sum(steady_state_plots) + equation_label
combined_plots.set_aspect_ratio(0.5)
combined_plots.show()

